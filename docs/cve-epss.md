#### 9. CVE add EPSS (`EPSS`) (`cve-epss`)

* Source collections: `nvd_cve_vertex_collection` (`type==note` objects only)

CVE Note objects have EPSS scores, e.g.

```json
    "x_epss": [
        {
            "date": "2024-08-18",
            "percentile": "0.328570000",
            "score": "0.000750000" 
        }
    ]
```

EPSS scores are updated daily. As such a user should be able to update EPSS scores.

EPSS data is downloaded using the endpoint. It will return the score for the current day.

```shell
GET https://api.first.org/data/v1/epss?cve=CVE-XXXX-XXXX
```

Running the script will update CVEs with the latest available EPSS data.

Should also add specific flag for this mode only `--cve-ids`. Here a user can pass a list of CVE IDs. In this case, only the CVE IDs passed will be updated. This is useful because often a user only wants to updated recent cves, and not very old ones. Should also be able to pass regex values for this property (e.g. `2024-2\n\n\n\n`). Will also work with `modified_min` flag.

On update a new version of the `note` object will be created, with the additional record added to the `x_epss` property.

```json
    "x_epss": [
        {
            "date": "2024-08-19",
            "percentile": "0.428920000",
            "score": "0.000900000"
        },
        {
            "date": "2024-08-18",
            "percentile": "0.328570000",
            "score": "0.000750000" 
        }
    ]
```

The `modified` time will also be updated to match the EPSS `date` value

All other fields will be the same.

The `_is_latest` will also be updated accordingly by stix2arango for the new and old object accordingly (as will embedded refs between note and vulnerability).

In some cases, the Note object won't already exist (sometimes it takes time for an EPSS score to be registered). In these cases Arango CTI Processor will create the Note object as follows, to add the EPSS score too...

```json
{
    "type": "note",
    "spec_version": "2.1",
    "id": "note--<UUID same as vulnerability object>",
    "created_by_ref": "identity--2e51a631-99d8-52a5-95a6-8314d3f4fbf3",
    "created": "<EARLIEST EPSS RECORDED>",
    "modified": "<LATEST EPSS RECORDED>",
    "content": "EPSS Score for <CVE ID>",
    "object_refs": [
        "vulnerability--CVE-vuln-object"
    ],
    "object_marking_refs": [
        "marking-definition--94868c89-83c2-464b-929b-a1a8aa3c8487",
        "marking-definition--2e51a631-99d8-52a5-95a6-8314d3f4fbf3"
    ],
    "extensions": {
        "extension-definition--efd26d23-d37d-5cf2-ac95-a101e46ce11d": {
            "extension_type": "toplevel-property-extension"
        }
    },
    "x_epss": [
        {
            "date": "<EPSS DATE>",
            "percentile": "<EPSS PERCENTILE>",
            "score": "<EPSS SCORE>"
        },
    ]
}
```
